// ==UserScript==
// @name         GeoFS-Alarms
// @namespace    https://github.com/fengshuo2004/geofs-alarms
// @version      0.1.1
// @description  Adds cockpit alarm sounds to GeoFS
// @author       PEK-97
// @match        https://www.geo-fs.com/geofs.php*
// @grant        none
// ==/UserScript==

(function () {
    'use strict';
    let stickShake = new Audio("data:audio/ogg;base64,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");
    stickShake.loop = true;
    // wait until flight sim is fully loaded
    let itv = setInterval(
        function(){
            if(window.ui && window.flight){
                main();
                clearInterval(itv);
            }
        }
    ,500);
    function main(){
        // monkey-patch the stallAlarm method
        let prev = false;
        window.ui.hud.stall.setVisOld = window.ui.hud.stall.setVisibility;
        window.ui.hud.stall.setVisibility = function (a) {
            if (a) {
                stickShake.play();
            } else if (!a && prev) {
                stickShake.pause();
            }
            prev = a;
            this.setVisOld(a);
        }
    }
})();